<!DOCTYPE html>
<html>

<head>
    <title> Task Tracking Helper </title>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Maven+Pro&display=swap" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
<!--     <link rel="manifest" href="site.webmanifest"> -->
<style type="text/css">
body {
    font-family: 'Maven Pro', sans-serif;
    margin: 0px;
    padding: 0px;
    border: none;
}
option{
    height: 24px;
    font-size: small;
}

div#content {
    display: grid;
    grid-template-columns: 24em auto;
    grid-template-rows: 64px auto;
    overflow: hidden;
    height: 100vh;
    font-size: small;
}

#main-controls , #stats-header{
    display: flex;
    padding-left: 0.4em;
    text-align: left;
    align-items: center;
    flex-direction: row;
    background: rgb(43, 128, 0);
    color: white;

}
#stats-header{
    display: grid;
    grid-template-rows: auto 24px;
    font-size: 1.5em;
    font-weight: bolder;
}
#generated-links{
    display: flex;
    flex-direction: row;
    place-items: center;
}
.generated-link {
    margin-right: 8px;
    border: none;
    border-top-left-radius: 4px;
    border-top-right-radius: 4px;
    background: white;
    color: rgb(43, 128, 0);
    padding-left: 8px;
    padding-right: 8px;
    font-size: 16px;
    height: 24px;
}

.generated-link:visited {
    margin-right: 8px;
    border: none;
    border-top-left-radius: 4px;
    border-top-right-radius: 4px;
    color: rgb(83, 197, 26);
    padding-left: 8px;
    padding-right: 8px;
    font-size: 16px;
    height: 24px;
}

#entry {
    display: flex;
    flex-direction: column;
    justify-self: auto;
    margin: 4px;
    border: 2px solid rgb(43, 128, 0);
    border-radius: 8px;
}
#tasks-info{
    margin-left: 0.5em;
    margin-right: 0.5em;
    display: flex;
    flex-direction: column;

}

#log {
    display: flex;
    overflow-x: hidden;
    overflow-y: scroll;
    margin: 0.5em;
    flex-direction: column;
}

#in-fields {
    display: grid;
    margin: 0.5em;
    font-size: 1em;
    grid-template-columns: auto 32px;
    grid-template-rows: auto ;
    grid-gap: 4px;
    justify-items: left;
    align-items: left;
    height: auto;
    margin-bottom: 1.5em;
}
.input-field {
    height:20px;
    margin: 0px;
    padding: 0px;
    border-left: none;
    border-right: none;
    border-top: none;
    border-bottom: 1px solid darkgray;
    font-size: 12px;
    width: 100%;
}
.input-field:focus{
    outline: none;
    border-left: none;
    border-right: none;
    border-top: none;
    border-bottom: 1px solid  rgb(73, 158, 0);

}
.input-field-container{
    width: 100%;
    display: grid;
    grid-template-columns: 100%;
    grid-template-rows: 12px 20px;
    height: 32px;
}

.input-field-label{
    margin: 0pxx;
    padding: 1px;
    height: 12px;
    color: rgb(59, 59, 59);
    font-size: 10px;
}

input.radio-option{display:none; width:0px; visibility: hidden;} 
input {
    border: 1px solid gray;
    width: 100%;
}

.check {
    width: 100%;
    height: 100%;
}

.label {
    justify-self: left;
}

.task {
    padding: 0em;
    padding-bottom: 0.1em;
}

.record-controls {
    margin: 4px;
    display: flex;
    flex-direction: row;
    justify-content: flex-end;
}
.control-btn{
    width: 80px;
    height: 32px;
    font-size: small;
    margin-left: 4px;
    background: whitesmoke;
    border: 1px solid gray;
    border-radius: 4px;
}
button.copy {
    display: flex;
    place-content: center;
    margin: none;
    padding: none;
    border: 1px solid darkgray;
    border-radius: 4px;
    background: whitesmoke;
    color: black;
    font-size: 1.8em;
    width: 32px;
    height: 32px;
}
button.copy:active {
    background: lightgray;
}
.delete-btn {
    margin-top: 1.5em;
    margin-left: none;
    margin-right: none;
    margin-bottom: none;
    padding: none;
    border: 1px solid darkgray;
    border-radius: 4px;
    background: whitesmoke;
    font-size: 1.8em;
    width: 32px;
    height: 32px;
}
.delete-btn:active {
    background: lightgray;
}
button.copy:focus {
    outline: none;
}
#comments-text {
    resize: none;
    flex-grow: 2;
    padding: 0.5em;
    font-size: small;
    border: 1px solid darkgray;
    border-radius: 4px;
}
#comments{
    margin: 4px;
    flex-grow: 2;
    display: inline-flex;
}
.record-container{
    height: min-content;
    display: grid;
    margin-left: 0.5em;
    grid-template-columns: 32px auto ;
    grid-template-rows: 32px auto ;
    margin: 4px;

}
.record-header{
    grid-column-start: 1;
    grid-column-end: 1;
    grid-row-start: 2;
    display: inline-flex;
    flex-direction: column;
    justify-content: top;
    align-items: center;
}
h3.count{
    text-align: center;
}
label.small-label{
    font-size: smaller;
    font-weight: bold;
    padding-right: 4px;
}
.record {
    margin-left: 4px;
    border:  1px solid gray;
    border-radius: 4px;
    white-space: pre-line;
    grid-column-start: 2;
    grid-row-start: 1;
    grid-row-end: 3;
    padding: 1em;
}
.record-untracked{
    background: rgb(255, 255, 179);
}
.record-tracked{
    background: rgb(179, 255, 179);
}
.emoticon{
    font-size: 1.5em;
    font-family: Arial, Helvetica, sans-serif;
}
.outcomes-container{
    display: inline-flex;
    flex-direction: row;
    font-size: small;
    justify-content: flex-end;
    align-content: flex-end;
    margin-bottom: 0.25em;
    padding-bottom: 0.25em;
    border-bottom: 1px solid green;
}
.to-unchecked {
    background: lightgray;
    color:  gray;
    padding:0.15em;
    border: 1px solid darkgray;
    border-radius: 0.2em;
    margin-left: 4px;
}
.to-checked {
    border: 1px solid green;
    background: greenyellow;
    padding:0.15em;
    border-radius: 0.2em;
    margin-left: 4px;
}
/* Records Group info*/

.rg-info{
    flex-grow: 2;
    display: flex;
    padding: 0px;
    height: 100%;
    margin: 4px;
    flex-direction: column;
}
#rg-selected-controls{
    width: 100%;
    display: grid;
    grid-template-columns: auto 32px;
    grid-template-rows: 32px;
    flex-grow: 2;
    gap: 4px;
    justify-self: flex-start;
    margin-top: 3px;
}
#rg-group-controls{
    margin-bottom: 2px;
    width: 100%;
    display: grid;
    grid-template-columns: auto 24px 24px 24px;
    grid-template-rows: 24px;
    gap: 2px;
    justify-self: flex-end;
}
#rg-list{
    border: 1px solid black;
    border-radius: 4px;
    background: lightgreen;
    height: 24px;
    font-size: small;
  
}
#rg-selected-name {
    background: rgb(73, 158, 0);
    border-radius: 4px;
    font-size: 1.2em;
    font-weight: bold;
    text-align: center;
    display: flex;
    place-content: center;
    flex-direction: column; 
    width: 100%;
    overflow: hidden;
}
.btn-rg{
    border: 1px solid black;
    background: whitesmoke;
    border-radius: 4px;
    font-size: 1.5em;
    display: flex;
    margin: 0px;
    padding: 0px;
    place-content: center;
    flex-direction: column;
    align-items: center;
}

.btn-rg-list{
    border: 1px solid black;
    background: whitesmoke;
    border-radius: 4px;
    font-size: 1.5em;
    display: flex;
    flex-direction: column;
    place-content: center;
    margin: 0px;
    padding: 0px;
    align-items: center;

}

.btn-rg:active{
    background: lightgray;
}

/* Settings */

#settings-container{
    margin-top: 0.5em;
    margin-left: 0.5em;
    margin-right: 0.5em;
    display: flex;
    flex-direction: column;
}
#settings-controls{
    height: 32px;
    display: flex;
    flex-direction: row;
}
#template-text{
    font-size: small;
    resize: none;
    flex-grow: 2;
    border: 1px solid darkgray;
    border-radius: 4px;
    padding: 0.4em;
}

#btn-settings{
    width: 32px;
    height: 32px;
    font-size: 2em;
    color: white;
    background: rgb(73, 158, 0);
    border:none;
    border-radius: 4px;
    padding: 0px;
    margin: 0px;
    place-content: center;
    display: flex;
    flex-direction: vertical;
}

#btn-settings:active{
    background: rgb(93, 178, 0);
}
#settings-controls > select {
    flex-grow: 2;
    border: 1px solid gray;
    border-radius: 4px;
    background: whitesmoke;
    appearance: none;
    overflow: hidden;
    width: 100%;
    margin-top: 2px;
    margin-bottom: 2px;
}
.settings-btn{
    width: 72px;
    padding: 0px;
    background: whitesmoke;
    border: 1px solid gray;
    border-radius: 4px;
    margin-left: 2px;
    margin-top: 2px;
    margin-bottom: 2px;
    font-size: smaller;
}

.settings-btn:active{
    background: darkgray;
}
</style></head>

<body>
    <div id="content">
        <div id="main-controls">
            <button title="Template Settings" id="btn-settings">&#x2699;</button>
            <div class="rg-info">
                <div id="rg-selected-controls">
                    <span id="rg-selected-name"></span>
                    <button title="Change Name" class="btn-rg" id="btn-change-name">&#x1F589;</button>
                </div>
                <div id="rg-group-controls" >
                <select name="rg-list" id="rg-list"></select>
                    <button title="Download current group" class="btn-rg-list" id="btn-rg-download">&#x21E9;</button>
                    <button title="Create new group" class="btn-rg-list" id="btn-rg-new">&plus;</button>
                    <button title="Delete current group" class="btn-rg-list" id="btn-rg-del">&minus;</button>
                </div>
            </div>
        </div>
        <div id="stats-header"> 
            <span id="title-text">Task Tracking helper </span>
            <div id="generated-links">
                <a href="tth.html" class="generated-link">
                Custom links
                </a>
            </div>
        </div>
        <div id="entry">
            <div id="settings-container"></div>
            <div class="input-fields-container" id="in-fields">
            </div>
            <div id="tasks-info">

            </div>
            <div id="comments" class="comments-container">
                <textarea name="comments-box" id="comments-text" placeholder="Comments"></textarea>
            </div>
            <div id="current-record-controls" class="record-controls">
                <button class="control-btn" id="btn-copy-current">Copy</button>
                <button class="control-btn" id="btn-track-current">Completed</button>
            </div>
        </div>
        <div id="log"></div>
    </div>
<script type="text/javascript">/*! For license information please see tth.js.LICENSE.txt */
!function(e){var t={};function n(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/index.js")}({"./favicon-16x16.png":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAzUlEQVQ4jWNgaNCoY2jQ+sHQoP2fNKz1g6FOs5aBoUH7J+makQwhXzMUDx4DhDut/p99dvX/44/P///68/v/2WdX/5fu6vm/6eb+/6uu7vzP0KD932VRyv9///79l+93we2Ckp3d/99//wjnb7554P9qqAGui1L+/////798vytpBtx4ff9/55G5/1de2U6eAQcfnPnvvDD5f9muXvIMoNgLJBnA1Kj7n7VJH85nbtT7z9yo95+hQfs/Y4MOitygSUjk5EQY1vrBQGl2BgCl9+uSpxZzqgAAAABJRU5ErkJggg==");\n\n//# sourceURL=webpack:///./favicon-16x16.png?')},"./favicon-32x32.png":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABPElEQVRYhWNgaGBgYqjTrGVo0HrO0KD1j6FB+z9tsdY/iF2aNQwMDIwMEMtpbSlOx1QxMNRrvxwwB9RrPWUYON9Do2NgHaD9f9QBow4YnA7Qnx70/++/vwSx6iTP/+mbG+D88NUlKOZ0HpkDl7ObF0e8A2T7nP/PPbcWjr/9+v7//////z/9+IIiLt5t9z9jS+N/GIhYg+qArqPz4HJ28+PJj4IXn9/8///////7759gyI06ANkBqZvq/wt3WsPx5JNL6esAfIAuDthwfd//9sOz4fjE44sjLA2MOmD4OoCr1fg/d6vJf64WYww5lib9/9ytJv+5W03+szTpocixNRvA5Zgadcl3AE3xqANGHUCf/iAurPWPAdJRHDAHPGNgaNCsGTAH1GlWMzA0MDBBHKH1jI7d82eQnjEDIwDdTq3DXjuTQwAAAABJRU5ErkJggg==");\n\n//# sourceURL=webpack:///./favicon-32x32.png?')},"./src/html-views.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return HTMLViews; });\n/* harmony import */ var _task_record_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./task-record.js */ "./src/task-record.js");\n/* harmony import */ var _favicon_16x16_png__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../favicon-16x16.png */ "./favicon-16x16.png");\n/* harmony import */ var _favicon_32x32_png__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../favicon-32x32.png */ "./favicon-32x32.png");\n// HTMLView\n// displays and retrieves info to and from the DOM \n\n\n\n\n\n//import {hash, copyToClipboard, copyInputToClipboard} from \'./trh.js\'\nclass HTMLViews {\n    constructor(tasksTrackingHelper){\n        this._tasksTrackingHelper = tasksTrackingHelper;\n        this._logCount = 0;\n        this._displayingSettings = false;\n        this.loadTemplateView();\n        this.showCurrentGroup();\n        this.updateRecordsGroupInfoView();\n        this.domParser = new DOMParser();\n\n        document.addEventListener(\n            \'DOMContentLoaded\',\n            (() => {\n                this.updateEventHandlers();\n                this.insertIcons();\n            }).bind(this)\n        );\n        \n    }\n    get logCount () {return this._logCount;}\n    set logCount (value) {this._logCount = value;}\n    get tasksTrackingHelper () {\n        return this._tasksTrackingHelper;\n    }\n    insertIcons(){\n        document.head.innerHTML += `<link rel="icon" type="image/png" sizes="32x32" href="${_favicon_32x32_png__WEBPACK_IMPORTED_MODULE_2__["default"]}">`;\n        document.head.innerHTML += `<link rel="icon" type="image/png" sizes="16x16" href="${_favicon_16x16_png__WEBPACK_IMPORTED_MODULE_1__["default"]}">`;\n    }\n\n    updateEventHandlers(){\n        // Clicks\n        let handlerList = [\n            ["click", "#current-record-controls", this.handleCurrentRecordActions],\n            ["click", "#log", this.handleLogActions],\n            ["click", "#btn-settings", this.toggleSettingsView],\n            ["click", "#btn-change-name", this.triggerRenameCurrentRecordsGroup],\n            ["click", "#btn-rg-new", this.triggerNewRecordsGroup],\n            ["click", "#btn-rg-del", this.triggerDeleteCurrentRecordsGroup],\n            ["click", "#btn-rg-download", this.triggerDownloadRecordsGroup],\n            ["click", "#settings-container", this.handleSettingsActions],\n            ["click", "#in-fields", this.handleInputActions],\n            ["click", "#tasks-info", this.handleTaskOutcomeChange],\n            ["change", "#rg-list", this.triggerChangeSelectedRececordsGroup],\n            ["change", "#entry", this.updateUnsavedRecord]\n        ]\n        handlerList.forEach(handlerDesc => { this.simpleAction( ...handlerDesc) }, this);\n    }\n    handleInputActions(event){\n        let id = event.target.id;\n        let arr = id.split("-");\n        if(arr[0] == "copy_input") {\n            this.copyToClipboard(document.getElementById(arr[1]).value);\n        }\n\n    }\n\n    simpleAction(action, selector, fn){\n        let element = document.querySelector(selector);\n        element.addEventListener(\n            action,\n            (() => { \n                let o = this;\n                o[fn.name](event);\n            }).bind(this)\n        );\n    }\n    handleTaskOutcomeChange(event){\n        if (event.target.tagName == \'INPUT\') {\n            if (event.target.id.match(/\\d+-\\d+/).length > 0) {\n                this.setOutcome(event.target.id);\n            }\n        }\n\n    }\n\n    copyRecord(id){\n        console.log("trying to copy " + id);\n        this.copyToClipboard(\n            this._tasksTrackingHelper\n                ._selectedRecordsGroup.getRecord(id).summary\n        )\n\n    }\n    handleLogActions(event){\n        let elementID = event.target.id ;\n        let arr       = elementID.split("-");\n        let fnList    = new Map();\n\n        fnList.set("dr",this.deleteRecordAndView);\n        fnList.set("chk",this.markRecordTrackedStatus);\n        fnList.set("copy", this.copyRecord);\n        let f = fnList.get(arr[0]);\n        if (f){\n            let h = this;\n            h[f.name](arr[1]);\n        }\n    }\n    markRecordTrackedStatus(id){\n        let status = document.getElementById("chk-"+id).checked;\n        this._tasksTrackingHelper._selectedRecordsGroup.setTrackedStatus(id, status);\n        this._tasksTrackingHelper.storeSelectedRecordsGroup();\n        this.updateRecordBackground(id);\n    }\n\n    updateRecordBackground(id){\n        let status = document.getElementById("chk-"+id).checked;\n        let record = document.getElementById(id);\n        if (status == true){\n            record.classList.remove("record-untracked");\n            record.classList.add("record-tracked");\n        } else {\n            record.classList.remove("record-tracked");\n            record.classList.add("record-untracked");\n        }\n\n    }\n\n    deleteRecordAndView(id){\n        console.log("dr: "+id)\n        let text = document.getElementById(id).innerText;\n        let ok   = confirm(\n            "Are you sure you want to delete:\\n" + \n            "================================\\n" + text\n            );\n        if(ok){\n            this._tasksTrackingHelper._selectedRecordsGroup.deleteRecord(id);\n            this._tasksTrackingHelper.storeSelectedRecordsGroup();\n            //this.showCurrentGroup();\n            let lc = document.getElementById("log");\n            let rc = document.getElementById("rc-"+id);\n            lc.removeChild(rc);\n            let recordsCount = \n                this._tasksTrackingHelper.\n                    _selectedRecordsGroup.records.length; \n            let cLabels = document.querySelectorAll(".record-container > div.record-header > h3");\n            if (cLabels){\n                let l = cLabels.length;\n                for (let index = 0 ; index < l; index++) {\n                    cLabels[index].innerText = l - index;\n                }\n                this._logCount = l ;\n            }\n            \n\n        }\n    }\n\n    handleSettingsActions (event) {\n        let tid = event.target.id;\n        switch (tid) {\n            case "template-save":\n                this.saveTemplateChanges();\n                break;\n            case "template-new":\n                this.createNewRecordsTemplate();\n                break;\n            case "template-delete":\n                this.deleteSelectedRecordsTemplateAndView();\n                break;\n            default:\n                break;\n        }\n\n    }\n\n    createNewRecordsTemplate(){\n        this._tasksTrackingHelper.addTemplate(\n            this.tasksTrackingHelper.generateDefaultTemplateText()\n        );\n        this.refreshSettingsViews();\n        this.loadTemplateView();\n    }\n    refreshSettingsViews(){\n        document.getElementById("template-text").value =\n            this._tasksTrackingHelper.selectedRecordsTemplate.templateText;\n        \n        this.loadTemplatesSelect();\n        document.getElementById("templates-select").value =\n            this._tasksTrackingHelper.selectedRecordsTemplate.name;\n\n    }\n    deleteSelectedRecordsTemplateAndView(){\n        let tn = this._tasksTrackingHelper.selectedRecordsTemplate.name;\n        let ok = confirm(`Are you sure you want to delete the template ${tn}?`)\n        if (ok){\n            this._tasksTrackingHelper.deleteSelectedRecordsTemplate();\n            this.loadTemplateView();\n            this.refreshSettingsViews();\n        }\n    }\n    loadTemplateView(){\n        this.createInputFields();\n        this.createTaskViews();\n        this.showUnsavedRecord();\n    }\n    \n    saveTemplateChanges() {\n        let tt = document.getElementById("template-text").value;\n        this._tasksTrackingHelper.changeCurrentRecordsTemplate(tt);\n        this.loadTemplatesSelect();\n        this.loadTemplateView();\n    }\n\n\n    updateTemplatesSelect(templateName){\n        let tth = this._tasksTrackingHelper;\n        tth.selectedRecordsTemplate = templateName;\n        let t   = tth.selectedRecordsTemplate;\n        document.getElementById("template-text").value = t.templateText;\n        tth._selectedRecordsGroup._type = t.name;\n        tth.storeSelectedRecordsGroup();\n        this.loadTemplateView();\n    }\n\n    // Records Group Section\n    updateRecordsGroupInfoView(){\n        this.updateRecordsGroupList();\n        this.updateSelectedGroupInfo();\n\n    }\n    updateRecordsGroupList(){\n        let rgl = document.getElementById("rg-list");\n        let options = this._tasksTrackingHelper._recordsGroupList\n            .map( n => `<option value="${n}">${n}</option>` );\n        let html = options.join("")\n        rgl.innerHTML = "";\n        rgl.innerHTML = html;\n    }\n    updateSelectedGroupInfo(){\n        let rgn = document.getElementById("rg-selected-name");\n        let n   = this._tasksTrackingHelper._selectedRecordsGroup.name;\n        rgn.innerText = n;\n        let rgl = document.getElementById("rg-list");\n        rgl.value = n;\n    }\n    triggerRenameCurrentRecordsGroup(){\n        let rg = this._tasksTrackingHelper._selectedRecordsGroup;\n        let rgNameDisplay = document.getElementById("rg-selected-name");\n        let changeNameBtn = document.getElementById("btn-change-name");\n        if (!rgNameDisplay.isContentEditable){\n            rgNameDisplay.contentEditable = true;\n            rgNameDisplay.focus();\n            changeNameBtn.innerHTML="&#x1f4be;"; // utf8 floppy disk\n        } else {\n            changeNameBtn.innerHTML="&#x1f589;"; // utf8 LOWER LEFT PENCIL\n            rgNameDisplay.contentEditable = false;\n            let newName = rgNameDisplay.innerText;\n            let oldName = rg.name;\n            if (newName != oldName) {\n                this._tasksTrackingHelper.renameCurrentRecordsGroup(newName);\n                this.updateRecordsGroupList();\n                this.updateSelectedGroupInfo();\n            }\n        }\n    }\n    triggerDownloadRecordsGroup(){\n        let rg = this._tasksTrackingHelper._selectedRecordsGroup;\n        let blob =  rg.toBlob();\n        let  objURL = window.URL.createObjectURL(blob);\n        let element = document.createElement("a");\n        element.href = objURL;\n        element.download = `${rg.name} ${rg.date}`\n        document.body.appendChild(element);\n        element.click();\n        document.body.removeChild(element);\n    }\n\n    triggerNewRecordsGroup(){\n        let name = "RG "+ new Date().toISOString().slice(0,19);\n        this._tasksTrackingHelper.setupNewRecordsGroup( name, \'Default\');\n        this.updateRecordsGroupList();\n        this.updateSelectedGroupInfo();\n        this.showCurrentGroup()\n    }\n\n    triggerDeleteCurrentRecordsGroup(){\n        let ok = confirm("Are you sure you want to delete the Records Group:\\n"\n            + this._tasksTrackingHelper._selectedRecordsGroup.name);\n        if (ok) {\n            this._tasksTrackingHelper.deleteCurrentRecordsGroup();\n            this.updateRecordsGroupList();\n            this.updateSelectedGroupInfo();\n            this.showCurrentGroup();\n            this.loadTemplateView();\n            if(this._displayingSettings) {\n                this.refreshSettingsViews();\n            }\n        }\n    \n    }\n\n    triggerChangeSelectedRececordsGroup(event){\n        let allDaltaSaved = this.isCurrentFormEmpty();\n        let ok = true;\n        if (!allDaltaSaved) {\n            ok = confirm("There is unsaved data, continue?");\n        }\n        if (ok) {\n            let sg = event.target.value;\n            this._tasksTrackingHelper.changeSelectedRecordsGroup(sg);\n            this.updateRecordsGroupList();\n            this.updateSelectedGroupInfo();\n            this.showCurrentGroup()\n            this.loadTemplateView();\n            let sc = document.getElementById("settings-container");\n            if(sc.hasChildNodes()) {\n                this.refreshSettingsViews();\n            }\n        }\n\n    }\n\n    createInputFields() {\n        this.tasksTrackingHelper.selectedRecordsTemplate.updateInputIDs().then((ids) => {\n            let inputFieldNames = this.tasksTrackingHelper.selectedRecordsTemplate.inputFieldNames;\n            let fieldsContainer = document.getElementById("in-fields");\n            fieldsContainer.innerHTML = "";\n            //let ids = this.tasksTrackingHelper.selectedRecordsTemplate.inputFieldIDs;\n            inputFieldNames.forEach((n, index) => {\n                fieldsContainer.innerHTML +=\n                    `<div class="input-field-container">\n                        <label for="${ids[index]}" class="input-field-label">${n}</label>\n                        <input class=\'input-field\' id="${ids[index]}" type="text">\n                    </div>\n                    <button tabindex="-1" id="copy_input-${ids[index]}" class=\'copy\' >&#x2398</button>`\n            });\n        }) ;\n    }\n\n    createTaskViews(){\n        let tasks = this._tasksTrackingHelper.selectedRecordsTemplate.tasks;\n        const infoDiv = document.getElementById("tasks-info");\n        infoDiv.innerHTML = "";\n        tasks.forEach(\n            (task, index) => {\n                let td = task.taskDescription;\n                infoDiv.innerHTML += `<div id=\'task-${index}\'  class=\'task\'>${td}</div>`;\n                infoDiv.innerHTML += `<div class="outcomes-container" id="oc-${index}"></div>`;\n                task.taskOutcomes.forEach(\n                    (taskOutcome, outcomeIndex) => {\n                        let taskOptionID = index + "-" + outcomeIndex;\n                        let html =\n                            `<input class=\'radio-option\' type="radio" \n                            id=${taskOptionID} name="tos-${index}" value=${taskOutcome}>\n                            <label class=\'to-unchecked\' for="${taskOptionID}">${taskOutcome}</label>`;\n                        let oc = document.getElementById(\'oc-\' + index);\n                        oc.innerHTML += html;\n                    });\n                \n            }\n        );\n        this.setDefaults();\n    }\n\n    toggleSettingsView(){\n        this._displayingSettings = (this._displayingSettings) ? false: true; //toggle\n        let settingsContainer = document.getElementById("settings-container");\n        if (this._displayingSettings){\n            let templateText = this._tasksTrackingHelper.selectedRecordsTemplate.templateText;\n            settingsContainer.style.height = "200px";\n            settingsContainer.innerHTML = `\n                    <textarea name="" id="template-text" ></textarea>\n                    <div id="settings-controls">\n                     <select name="templates-select" id="templates-select"></select>\n                     <button class="settings-btn" id="template-new">New</button>\n                     <button class="settings-btn" id="template-save">Save</button>\n                     <button class="settings-btn" id="template-delete">Delete</button>\n                    </div>\n                    `;\n            this.loadTemplatesSelect();\n            this.checkForElement(\'template-text\').then(tt => tt.value = templateText);\n            let selecthandler = (event) => {\n                console.log("fired!")\n                console.log(event.target.value);\n                this.updateTemplatesSelect(event.target.value);\n            }\n            selecthandler.bind(this);\n            this.checkForElement(\'templates-select\').then( templatesSelect =>\n                templatesSelect.onchange = selecthandler\n\n            );\n        } else {\n            settingsContainer.style.height = "0px";\n            settingsContainer.innerHTML = "";\n        }\n    }\n\n    loadTemplatesSelect(){\n        this.checkForElement("templates-select").then(\n            templatesSelect => {\n                let rtOptions = Array.from(this._tasksTrackingHelper._recordsTemplates)\n                    .map(rt => {\n                        let tn = rt[1].name;\n                        return `<option value="${tn}">${tn}</option>`;\n                    });\n                templatesSelect.innerHTML = rtOptions.join("");\n                templatesSelect.value = \n                    this._tasksTrackingHelper.selectedRecordsTemplate.name;\n\n            }\n        );\n    }\n\n    async animateGrow(element, size, duration){\n        let d = (duration/1000) * 60;\n        for (let index = 0; index < d; index++) {\n            requestAnimationFrame(() => {\n                let h =  size / d * index ;\n                element.style.height =  h + "px";\n            });\n            await new Promise(resolve => requestAnimationFrame(resolve));\n        }\n    }\n\n    setOutcome(toid) {\n        this._tasksTrackingHelper.updateSelectedTaskOutcome(...toid.split("-"));\n        let taskID = toid.split("-")[0];\n        let tasks = this._tasksTrackingHelper._selectedRecordsTemplate.tasks;\n        tasks[taskID].taskOutcomes.forEach((to, i) => {\n            toid = taskID + "-" + i;\n            let radioOption = document.getElementById(toid);\n            if (radioOption.checked) {\n                radioOption.labels[0].className = "to-checked";\n                document.getElementById("task-" + taskID).innerHTML = tasks[taskID].taskDescription + " " + to;\n            } else {\n                radioOption.labels[0].className = "to-unchecked";\n            }\n        });\n    }\n\n    setDefaults() {\n        console.log("Setting default outcomes");\n        let tasks = this._tasksTrackingHelper._selectedRecordsTemplate.tasks;\n        tasks.forEach((t, i) => {\n            var firstTaskOptionId = i + "-0";\n            document.getElementById(firstTaskOptionId).checked = true;\n            this.setOutcome(firstTaskOptionId);\n        });\n    }\n\n    getTaskInfo(taskID) {\n        return document.getElementById("task-" + taskID).innerText;\n    }\n    \n    getCurrentInfo() {\n        let ids = this._tasksTrackingHelper.selectedRecordsTemplate.inputFieldIDs;\n        let inputFieldNames = this._tasksTrackingHelper.selectedRecordsTemplate.inputFieldNames;\n        let tasks = this._tasksTrackingHelper.selectedRecordsTemplate.tasks;\n        let info = "";\n        ids.forEach(\n            (id, index) => {\n                var v = document.getElementById(id).value\n                info += `${inputFieldNames[index]}: ${v}\\n`\n            }\n        );\n        tasks.forEach((_, index) => {\n            info += this.getTaskInfo(index) + "\\n";\n        });\n        info += "Comments:\\n" + document.getElementById("comments-text").value + "\\n";\n        return info\n    }\n\n    isCurrentFormEmpty () {\n        let hasFilledFields = false;\n        let hasComments = (document.getElementById("comments-text").value > 0);\n        let ids = this._tasksTrackingHelper.selectedRecordsTemplate.inputFieldIDs;\n\n        for (var index = 0, n = ids.length; index < n; index++) {\n            var inField = document.getElementById(ids[index]);\n            if (inField.value.length > 0) {\n                hasFilledFields = true;\n                break;\n            }\n        }\n        return !hasFilledFields && !hasComments;\n    }\n\n    showUnsavedRecord(){\n        let tth = this._tasksTrackingHelper;\n        tth.loadUnsavedRecord();\n        let show = (ids) => {\n            let fieldsInfo = tth._unsavedRecord._fieldsInfo;\n            try {\n                ids.forEach((elementId, index) => {\n                    this.checkForElement(elementId).then(\n                        (element) => {\n                            element.value = fieldsInfo[index][1]\n                        }\n                    )\n                    \n                },this);\n            } catch (error) {\n                console.log(error)\n            }\n\n            try {\n                tth._taskOutcomesSelected.forEach(\n                    (outcomeIndex, taskIndex) => {\n                        let toid = taskIndex + "-" + outcomeIndex;\n                        let outcomeElement = document.getElementById(toid);\n                        outcomeElement.checked = true;\n                        this.setOutcome(toid);\n\n                    }\n                    , this);\n                \n            } catch (error) {\n                console.log(error)\n            }\n            try {\n                document.getElementById("comments-text").value = tth._unsavedRecord._comments;\n                \n            } catch (error) {\n                console.log(error)\n                \n            }\n\n        }\n        show.bind(this);\n\n        tth.selectedRecordsTemplate.updateInputIDs().then(show);\n        \n    }\n\n    updateUnsavedRecord(event){\n        let target = event.target\n        let parent = event.target.parentNode;\n        let tth = this.tasksTrackingHelper;\n        switch (parent.className) {\n            case "input-field-container":\n                let index = tth._selectedRecordsTemplate\n                    ._inputFieldIDs.indexOf(target.id);\n                let value =  document.getElementById(target.id).value;\n                let fieldName = tth._selectedRecordsTemplate._inputFieldNames[index];\n                tth._unsavedRecord._fieldsInfo[index] = [fieldName,value];\n                break;\n\n            case "outcomes-container":\n                let arr = target.id.split("-");\n                tth.updateSelectedTaskOutcome(...arr);\n                break;\n\n            case "comments-container":\n                tth._unsavedRecord._comments = \n                    document.getElementById(target.id).value;\n                break;\n            default:\n                break;\n        }\n        tth.storeUnsavedRecord();\n        //let parent\n        //this._tasksTrackingHelper.storeUnsavedRecord();\n    }\n\n    handleCurrentRecordActions(event){\n        switch (event.target.id) {\n            case \'btn-copy-current\':\n                this.copyToClipboard(this.getCurrentInfo());\n                break;\n            case \'btn-track-current\':\n                this.trackCurrent();\n                break;\n            default:\n                break;\n        }\n\n    }\n\n    trackCurrent() {\n        console.log("Tracking")\n        let hasEmptyFields = false;\n        let ids = this._tasksTrackingHelper.selectedRecordsTemplate.inputFieldIDs;\n        let taskRecordsGroup = this._tasksTrackingHelper._selectedRecordsGroup;\n        let selectedTemplate = this._tasksTrackingHelper._selectedRecordsTemplate;\n\n        for (var index = 0, n = ids.length; index < n; index++) {\n            var inField = document.getElementById(ids[index]);\n            if (inField.value.length == 0) {\n                inField.focus();\n                hasEmptyFields = true;\n                break;\n            }\n        }\n\n        if (!hasEmptyFields) {\n            var info = this.getCurrentInfo();\n            // Create fields Array\n            let fieldsInfo = ids.map((id, index) => \n                [selectedTemplate.inputFieldNames[index], \n                document.getElementById(id).value]);\n\n            // Create tasks and Outcomes Array\n            let tasksAndOutcomes = this._tasksTrackingHelper._taskOutcomesSelected\n                .map(\n                    (outcomeIndex, taskIndex) => {\n                        let tasks = selectedTemplate.tasks;\n                        let desc = tasks[taskIndex].taskDescription\n                        let outcome = tasks[taskIndex].taskOutcomes[outcomeIndex]\n                        return [desc, outcome];\n                    }\n                );\n\n            let comments = document.getElementById("comments-text").value;\n            var tr = new _task_record_js__WEBPACK_IMPORTED_MODULE_0__["default"](fieldsInfo, tasksAndOutcomes, comments, "");\n            taskRecordsGroup.addRecord(tr);\n            this._tasksTrackingHelper.storeSelectedRecordsGroup();\n            tr.recalculateID().then(() => this.showInLog(tr));\n            this.clearFields();\n            this._tasksTrackingHelper.storeUnsavedRecord(); // After cleared\n        }\n    }\n\n    showInLog(taskRecord) {\n        let logDiv = document.getElementById("log");\n        this._logCount += 1;\n        let id = taskRecord.id;\n        let record =\n            `<div class=\'record-container\' id=\'rc-${id}\'>\n                    <button class=\'copy\' id=\'copy-${id}\'>&#x2398;</button>\n                    <div class=\'record-header\'> \n                        <h3 class=\'count\'>${this.logCount}</h3> \n                        <label for=\'chk-${id}\' class=\'small-label\'>Tracked</label> \n                        <input id=\'chk-${id}\' type=\'checkbox\'/>\n                        <button class=\'delete-btn\' id=\'dr-${id}\'>&#x1F5D1;</button>\n                    </div>\n                    <div id=\'${id}\' class=\'record\'>${taskRecord.getInfo()}</div> \n            </div>`;\n        let element =  this.domParser.parseFromString(record.toString(), \'text/html\');\n        logDiv.prepend(element.body.firstChild);\n        let status = taskRecord.tracked;\n        this.checkForElement(\'chk-\'+id).then(el => el.checked = status);\n        this.checkForElement(id).then(el => this.updateRecordBackground(el.id));\n        \n    }\n\n    showCurrentGroup() {\n        let logDiv = document.getElementById("log").innerHTML = "";\n        let taskRecords = this._tasksTrackingHelper._selectedRecordsGroup.records;\n        this._logCount = 0;\n        for (let index = 0; index < taskRecords.length; index++) {\n            const tr = taskRecords[index];\n            tr.recalculateID().then( (() =>  this.showInLog(tr)).bind(this));\n        }\n    }\n\n    clearFields() {\n        let ids = this._tasksTrackingHelper.selectedRecordsTemplate.inputFieldIDs;\n        ids.forEach(id => document.getElementById(id).value = "");\n        this.setDefaults();\n        this._tasksTrackingHelper.resetUnsavedRecord();\n        document.getElementById("comments-text").value = "";\n    }\n    // Copy current info to clipboard\n    // copyInfo\n    copyToClipboard(text) {\n        navigator.clipboard.writeText(text).then(function () {\n            /* clipboard successfully set */\n            console.log("Text copied");\n        }, function () {\n            /* clipboard write failed */\n            console.log("Text not copied");\n        });\n\n    }\n    async checkForElement(id) {\n        let el = null;\n        do {\n            await new Promise(resolve => requestAnimationFrame(resolve));\n            el = document.getElementById(id);\n        } while (el === null);\n        return el;\n    }\n\n}\n\n\n\n//# sourceURL=webpack:///./src/html-views.js?')},"./src/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _style_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./style.css */ "./src/style.css");\n/* harmony import */ var _style_css__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_style_css__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tasks_tracking_helper_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tasks-tracking-helper.js */ "./src/tasks-tracking-helper.js");\n/* harmony import */ var _trh__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./trh */ "./src/trh.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "copyToClipboard", function() { return _trh__WEBPACK_IMPORTED_MODULE_2__["copyToClipboard"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "copyInputToClipboard", function() { return _trh__WEBPACK_IMPORTED_MODULE_2__["copyInputToClipboard"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hash", function() { return _trh__WEBPACK_IMPORTED_MODULE_2__["hash"]; });\n\n//\n// Copyright (c) 2020, J. Garcia <0x4a.dev at gmail.com> \n// All rights reserved.\n// \n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//     * Redistributions of source code must retain the above copyright\n//       notice, this list of conditions and the following disclaimer.\n//     * Redistributions in binary form must reproduce the above copyright\n//       notice, this list of conditions and the following disclaimer in the\n//       documentation and/or other materials provided with the distribution.\n//     * Neither the name of the copyright holder nor the\n//       names of its contributors may be used to endorse or promote products\n//       derived from this software without specific prior written permission.\n// \n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND\n// ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n// WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER BE LIABLE FOR ANY\n// DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n// LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n// ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n\n\n\n\n\n\nlet tth = new _tasks_tracking_helper_js__WEBPACK_IMPORTED_MODULE_1__["default"]();\n\n//# sourceURL=webpack:///./src/index.js?')},"./src/records-group.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return RecordsGroup; });\n// RecordsGroup\n// Holds a records group with date and type\nclass RecordsGroup {\n    constructor(name,type, ...args) {\n        this._type = type;\n        this._name = name;\n        this._date = \n            (args.length == 2) ?\n                args[0] :\n                new Date().toISOString().replace("T", " ").substring(0, 19);\n        this._id = this.generateID();\n        this._records = (args.length == 2) ? args[1]: [];\n    }\n\n    get id (){return this._id;}\n    get date (){return this._date;}\n    get type (){return this._type;}\n    set type(t){this._type = t;}\n    get records (){return this._records;}\n    get name (){return this._name;}\n    set name (name){\n        this._name = name;\n        this._id = this.generateID();\n    }\n    \n    generateID () { \n        return this._name; \n    }\n    addRecord(r) {\n        this._records.push(r);\n    }\n    deleteRecord(id) {\n        this._records =\n            this._records.filter(r => r.id !== id);\n        console.log("deleted: " +id);\n        console.log(this._records);\n    }\n    setTrackedStatus(id, status) {\n        let r = this._records.find(r => r.id === id);\n        r.tracked = status;\n    }\n    getTrackedStatus(id) {\n        let r = this._records.find(r => r.id === id);\n        return r.tracked ;\n    }\n    toPrettyString(){\n        let dashes = "\\n" + "-".repeat(80) + "\\n";\n        let stars = "*".repeat(80) + "\\n";\n        let info = stars;\n        info += `Records Group : ${this.name}\\nCreated on: ${this.date}\\n`;\n        info += stars;\n        info += this.records.map(r => r._summary).join(dashes);\n        return info;\n    }\n    getRecord(id){\n        let r = this._records.find(r => r.id === id);\n        console.log(r);\n        return r;\n    }\n    toBlob(){\n        return new Blob([this.toPrettyString()],{type: "text/plain", endings:"native"});\n    }\n}\n\n//# sourceURL=webpack:///./src/records-group.js?')},"./src/records-template.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return RecordsTemplate; });\n/* harmony import */ var _trh_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./trh.js */ "./src/trh.js");\n/* harmony import */ var _task_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./task.js */ "./src/task.js");\n\n\n\n// RecordsTemplate\n// Stores input values and tasks related to \n// a Record type\nclass RecordsTemplate {\n    constructor(templateText){\n        this._templateText = templateText;\n        this.updateTemplate();\n    }\n    get name() { return this._name; }\n    set name(n) { this._name = n; }\n    get inputFieldNames() { return this._inputFieldNames; }\n    get inputFieldIDs() { return this._inputFieldIDs; }\n    get tasks() { return this._tasks; }\n    get templateText() { return this._templateText; }\n    set templateText(text) { \n        this._templateText = text; \n        this.updateTemplate(); \n    }\n\n    updateTemplate() {\n        let rawLines = this._templateText.split(\'\\n\');\n        this._lines = rawLines.filter(l => l.length > 0);\n        try {\n            // attempt parse\n            let newName = this.generateNameFromTemplate();\n            let newInputFieldNames = this.generateInputFields();\n            let newTasks = this.generateTasks();\n            // assign values if no errors returned\n            this._name = newName;\n            this._inputFieldNames = newInputFieldNames;\n            this._inputFieldIDs = [];\n            this._tasks = newTasks;\n        } catch (error) {\n            this._name = "Parse Error";\n            this._inputFieldNames = ["Error"];\n            this._inputFieldIDs = [];\n            this._tasks = [new _task_js__WEBPACK_IMPORTED_MODULE_1__["default"]("Error::Error")];\n            console.log(error);\n        }\n\n    }\n\n    async updateInputIDs(){\n        this._inputFieldIDs = [];\n        let ids = []\n        for (let index = 0, length = this._inputFieldNames.length; index < length; index++) {\n            ids.push(await Object(_trh_js__WEBPACK_IMPORTED_MODULE_0__["hash"])(this._inputFieldNames[index]))\n        }\n        this._inputFieldIDs = ids;\n        return ids;\n    }\n\n    generateNameFromTemplate(){\n        if (this._lines[0].match(/[^\\s]+/)) {\n            return this._lines[0];\n        } else {\n            throw new SyntaxError("No name entered");\n        }\n    }\n    generateInputFields(){\n        if (this._lines[1] !== undefined) {\n            let reg = /(?:^Fields:\\s*)(.+)$/;\n            let match = this._lines[1].match(reg);\n            if (match) {\n                return match[1].split(\',\');\n\n            } else {\n                throw new SyntaxError("No fields entered");\n            }\n        } \n    }\n    generateTasks(){\n        let tasks = [];\n        let lines = this._templateText.split(\'\\n\');\n        if (lines[2].match(/Tasks:\\n/g) != 0 ){\n            for (let index = 3, count = lines.length; index < count; index++) {\n                const element = lines[index];\n                try {\n                    tasks.push(new _task_js__WEBPACK_IMPORTED_MODULE_1__["default"](element));\n                } catch (error) {\n                   //bubble up the error\n                   throw error;\n                }\n            }\n        } else {\n                throw new SyntaxError("No tasks entered");\n        }\n        return tasks;\n    }\n\n}\n\n//# sourceURL=webpack:///./src/records-template.js?')},"./src/style.css":function(module,exports,__webpack_require__){eval("// extracted by mini-css-extract-plugin\n\n//# sourceURL=webpack:///./src/style.css?")},"./src/task-record.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return TaskRecord; });\n/* harmony import */ var _trh_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./trh.js */ "./src/trh.js");\n// TaskRecord\n// Stores the outcomes and entered fields in a single string.\n\nclass TaskRecord{\n    constructor(fieldsInfo, tasksAndOutcomes , comments, creationDate) {\n        this._fieldsInfo = fieldsInfo;\n        this._tasksAndOutcomes = tasksAndOutcomes;\n        this._comments = comments;\n        this.tracked = false\n        this._creationDate = creationDate;\n        if (this._creationDate == "") {\n            var now = new Date()\n            this._creationDate = now.toISOString().replace("T", " ").substring(0, 19);\n        }\n        this._summary = this.getInfo();\n    }\n    get tracked(){ return this._tracked;}\n    get summary(){ return this._summary;}\n    set tracked(val){this._tracked = val}\n    async recalculateID () {\n        this.id = await Object(_trh_js__WEBPACK_IMPORTED_MODULE_0__["hash"])(this._summary);\n    }\n    getInfo() {\n        let info = this._fieldsInfo.map(infoPair => infoPair.join(": ")).join("\\n");\n        info += "\\n";\n        info += this._tasksAndOutcomes.map(infoPair => infoPair.join(" ")).join("\\n");\n        info += "\\n";\n        info += "Comments:\\n" + this._comments || false;\n        info += "\\n";\n        info += "Date: " + this._creationDate;\n        return info;\n    }\n    \n\n}\n\n//# sourceURL=webpack:///./src/task-record.js?')},"./src/task.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Task; });\n/* \n  MyTask \n  Defined by a single line string in the format:\n  TaskDescription::Outcome1/Outcome2...\n  where :: delimitts description and outcomes\n  and slash delimits each possible outcome\n */\nclass Task {\n    constructor(defString){\n        this._defString = defString;\n        let parts = this._defString.split("::");\n        if (parts.length != 2) {\n            throw new SyntaxError(\n                `Invalid Task definition: ${this._defString}`);\n        };\n        this._taskDescription = parts[0];\n        this._taskOutcomes = parts[1].split("/");\n        if (this._taskOutcomes.length == 0) {\n            throw new SyntaxError(\n                `Invalid Task definition: ${this._defString}\\n\n                missing outcomes`);\n        }\n    }\n    get taskDescription() {\n        return this._taskDescription;\n    }\n    get taskOutcomes (){\n        return this._taskOutcomes;\n    }\n}\n\n//# sourceURL=webpack:///./src/task.js?')},"./src/tasks-tracking-helper.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return TasksTrackingHelper; });\n/* harmony import */ var _records_template_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./records-template.js */ "./src/records-template.js");\n/* harmony import */ var _records_group_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./records-group.js */ "./src/records-group.js");\n/* harmony import */ var _html_views_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./html-views.js */ "./src/html-views.js");\n/* harmony import */ var _task_record_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./task-record.js */ "./src/task-record.js");\n\n\n\n\n// Main Object Class\n// Defines the main general variables and functions to start the app\nclass TasksTrackingHelper {\n\n    constructor(){\n        this._recordsTemplates = this.loadTemplates();\n        this._selectedRecordsTemplate = this.loadSelectedTemplate();\n        this._recordsGroupList = this.loadRecordsGroupList();\n        this._selectedRecordsGroup = this.loadSelectedRecordsGroup(); \n        this._taskOutcomesSelected = [];\n        this._unsavedRecord =  null;\n        //this.loadUnsavedRecord();\n        this._htmlViews = new _html_views_js__WEBPACK_IMPORTED_MODULE_2__["default"](this);\n    }\n\n    storeUnsavedRecord(){\n        this.localSave("unsavedRecord", this._unsavedRecord);\n        this.localSave("unsavedOutcomes", this._taskOutcomesSelected);\n    }\n\n    resetUnsavedRecord(){\n        this._unsavedRecord._fieldsInfo.forEach(field => field[1] ="");\n        this._unsavedRecord._comments ="";\n        this._taskOutcomesSelected = [];\n        this._selectedRecordsTemplate.tasks\n            .forEach(() => this._taskOutcomesSelected.push(0), this);\n        this.storeUnsavedRecord();\n    }\n\n    loadUnsavedRecord(){\n        let recordObj = this.loadLocalJSON("unsavedRecord");\n        let comments = (recordObj) ? recordObj._comments : "";\n        let record = new _task_record_js__WEBPACK_IMPORTED_MODULE_3__["default"]([],[],comments,"");\n        let oldFieldsInfo = new Map(\n            (recordObj) ? recordObj._fieldsInfo : []\n        );\n        let rt = this._selectedRecordsTemplate;\n        let updatedFieldsInfo = [];\n        rt._inputFieldNames.forEach(fieldName => {\n            let value = (oldFieldsInfo.has(fieldName)) ?\n                oldFieldsInfo.get(fieldName) : "";\n            updatedFieldsInfo.push([fieldName, value]);\n        });\n        record._fieldsInfo = updatedFieldsInfo;\n        this._unsavedRecord = record;\n\n        let storedTaskOutcomes =\n            this.loadLocalJSON("unsavedOutcomes", this._taskOutcomesSelected)\n            || Array(rt.tasks.length).fill(0);\n        let updatedTaskOutcomes = Array(rt.tasks.length).fill(0);\n        let copyEnd = (storedTaskOutcomes.length >= rt.tasks.length) ?\n            rt.tasks.length :\n            storedTaskOutcomes.length;\n        for (let index = 0; index < copyEnd; index++) {\n            updatedTaskOutcomes[index] =\n                (storedTaskOutcomes[index] <=\n                    rt.tasks[index].taskOutcomes.length) ?\n                    storedTaskOutcomes[index] : 0;\n\n        }\n        storedTaskOutcomes = updatedTaskOutcomes; \n        this._taskOutcomesSelected = storedTaskOutcomes;\n    }\n    get recordsGroupList () {return this._recordsGroupList};\n    generateDefaultTemplateText() {\n        let defaultTemplate = "";\n        defaultTemplate +=\n            (this._recordsTemplates.get("Default")) ?\n                "Default " + new Date().toISOString() + "\\n":\n                "Default\\n";\n        defaultTemplate +=\n            "Fields:ID\\n" +\n            "Tasks:\\n" +\n            "Completed?::Yes/No";\n        return defaultTemplate;\n    }\n\n    loadRecordsGroupList(){\n        let rgl = this.loadLocalJSON(\'recordsGroupList\') || [];\n        return rgl;\n    }\n    storeRecordsGroupList(){\n        this.localSave(\'recordsGroupList\', this.recordsGroupList);\n    }\n\n    storeSelectedRecordsGroup(){\n        this.localSave("selectedRecordsGroup",this._selectedRecordsGroup.id );\n        this.localSave(this._selectedRecordsGroup.id , this._selectedRecordsGroup);\n    }\n\n    loadSelectedRecordsGroup(){\n        let recordsGroupID = localStorage.getItem("selectedRecordsGroup");\n        recordsGroupID = JSON.parse(recordsGroupID);\n        let rg = null;\n        if (recordsGroupID != null) {\n            let obj = this.loadLocalJSON(recordsGroupID);\n            if (obj !== null){\n                let records = obj._records.map(\n                    r => {\n                        let taskRecord = new _task_record_js__WEBPACK_IMPORTED_MODULE_3__["default"](\n                            r._fieldsInfo,\n                            r._tasksAndOutcomes,\n                            r._comments,\n                            r._creationDate);\n                        taskRecord.tracked = r._tracked;\n                        return taskRecord ;\n                    });\n                rg = new _records_group_js__WEBPACK_IMPORTED_MODULE_1__["default"](obj._name, obj._type, obj._date, records);\n            }  else {\n                rg = this.setupNewRecordsGroup(\'Default Group\',\'Default\');\n            } \n\n        } else {\n            rg = this.setupNewRecordsGroup(\'Default Group\', \'Default\');\n\n        }\n        if (this._recordsTemplates.has(rg.type) &&\n            (rg.type != this._selectedRecordsTemplate.name)) {\n                this.selectedRecordsTemplate = rg.type\n        } else if ( !this._recordsTemplates.has(rg.type)) {\n            rg.type = this._selectedRecordsTemplate.name;\n            this.storeSelectedRecordsGroup();\n        }\n        return rg;\n    }\n    deleteCurrentRecordsGroup(){\n        let currentID = this._selectedRecordsGroup.id;\n        this._recordsGroupList = this.recordsGroupList.filter( id => id != currentID );\n        this.storeRecordsGroupList();\n        this.localSave("selectedRecordsGroup", "");\n        localStorage.removeItem(currentID);\n        if (this.recordsGroupList.length > 0) {\n            this.localSave("selectedRecordsGroup", this.recordsGroupList[0]);\n        }\n        this._selectedRecordsGroup = this.loadSelectedRecordsGroup();\n    }\n    setupNewRecordsGroup(name, type){\n        let rg = new _records_group_js__WEBPACK_IMPORTED_MODULE_1__["default"](name,type);\n        this._recordsGroupList.push(rg.id);\n        this.storeRecordsGroupList();\n        this._selectedRecordsGroup = rg;\n        this.storeSelectedRecordsGroup();\n        return rg;\n    }\n    changeSelectedRecordsGroup(id) {\n        this.localSave("selectedRecordsGroup", id);\n        this._selectedRecordsGroup = this.loadSelectedRecordsGroup();\n    }\n    renameCurrentRecordsGroup(newName){\n        let repeated = this.recordsGroupList.includes(newName);\n        if (!repeated) {\n            let oldID = this._selectedRecordsGroup.id;\n            this._selectedRecordsGroup.name = newName;\n            this._recordsGroupList = this.recordsGroupList.filter( id => id != oldID);\n            this._recordsGroupList.push(newName);\n            this._recordsGroupList = this.recordsGroupList.sort();\n            this.storeRecordsGroupList();\n            this.storeSelectedRecordsGroup();\n            localStorage.removeItem(oldID);\n        }\n    }\n\n    get selectedRecordsTemplate(){\n        return this._selectedRecordsTemplate;\n    }\n    set selectedRecordsTemplate(name){\n        localStorage.setItem(\'selectedRecordsTemplate\', name);\n        this._selectedRecordsTemplate = this.loadSelectedTemplate();\n    }\n\n    updateSelectedTaskOutcome(taskIndex,outcomeIndex){\n        this._taskOutcomesSelected[taskIndex] = outcomeIndex;\n    }\n    \n    loadSelectedTemplate(){\n        let name = localStorage.getItem("selectedRecordsTemplate");\n        let rt  = name ? this._recordsTemplates.get(name): null;\n        if (rt === null) {\n            name = this._recordsTemplates.keys().next().value;\n            rt = this._recordsTemplates.get(name);\n            localStorage.setItem(\'selectedRecordsTemplate\', name);\n        }\n        return rt;\n    }\n\n\n    changeCurrentRecordsTemplate(text) {\n        let t = new _records_template_js__WEBPACK_IMPORTED_MODULE_0__["default"](text);\n        let currentName = this.selectedRecordsTemplate.name;\n        if (t.name != currentName) {\n            this._recordsTemplates.delete(currentName)\n        }\n        this._recordsTemplates.set(t.name, t);\n        this.selectedRecordsTemplate = t.name;\n        this.storeTemplates();\n        this.loadTemplates();\n        this._selectedRecordsGroup._type = t.name;\n        this.storeSelectedRecordsGroup();\n    }\n\n\n    storeTemplates(){\n        localStorage.setItem(\'selectedRecordsTemplate\', this.selectedRecordsTemplate.name);\n        let arr = Array.from(this._recordsTemplates).map( rt => rt[1].templateText);\n        localStorage.setItem("storedTemplates", JSON.stringify(arr));\n    }\n\n    addTemplate(text){\n        const rt = new _records_template_js__WEBPACK_IMPORTED_MODULE_0__["default"](text);\n        this._recordsTemplates.set(rt.name,rt);\n        this.selectedRecordsTemplate = rt.name;\n        this._selectedRecordsGroup.type = rt.name;\n        this.storeTemplates();\n        this.storeSelectedRecordsGroup();\n    }\n    deleteSelectedRecordsTemplate(){\n        let stName = this.selectedRecordsTemplate.name\n        this._recordsTemplates.delete(stName)\n        this.storeTemplates();\n        let newSelection = this._recordsTemplates.keys().next()\n        if (newSelection.value) {\n            this.selectedRecordsTemplate = newSelection.value;\n        } else {\n            this.loadTemplates();\n        }\n    }\n\n    loadTemplates(){\n        let jsonTemplates = this.loadLocalJSON(\'storedTemplates\');\n        this._recordsTemplates = new Map();\n        if (jsonTemplates != null) {\n            jsonTemplates.forEach(\n                templateText => {\n\n                    let rt = new _records_template_js__WEBPACK_IMPORTED_MODULE_0__["default"](templateText);\n                    if (rt){\n                        this._recordsTemplates.set(rt.name, rt);\n                    }\n                }\n            );\n        }\n        if (this._recordsTemplates.size == 0 ){\n            console.log("No stored templates, generating default")\n            let defaultTemplate =  this.generateDefaultTemplateText();\n            let rt = new _records_template_js__WEBPACK_IMPORTED_MODULE_0__["default"](defaultTemplate)\n            this._recordsTemplates.set(rt.name, rt);\n            this._selectedRecordsTemplate = rt;\n            this.storeTemplates();\n        }\n        return this._recordsTemplates;\n    }\n\n    localSave(key, obj) {\n        localStorage.setItem(key, JSON.stringify(obj));\n    }\n\n    loadLocalJSON (key) {\n        let jsonString =  localStorage.getItem(key);\n        return  ( jsonString != null) ?  JSON.parse(jsonString) : null;\n    }\n}\n\n\n//# sourceURL=webpack:///./src/tasks-tracking-helper.js?')},"./src/trh.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "copyToClipboard", function() { return copyToClipboard; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "copyInputToClipboard", function() { return copyInputToClipboard; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hash", function() { return hash; });\n// Sipmple general use functions\nfunction copyToClipboard(divID) {\n    var r = document.createRange();\n    r.selectNode(document.getElementById(divID));\n    window.getSelection().removeAllRanges();\n    window.getSelection().addRange(r);\n    document.execCommand("copy");\n    window.getSelection().removeAllRanges();\n}\nfunction copyInputToClipboard(inputID) {\n    document.getSelection().removeAllRanges();\n    document.getElementById(inputID).select();\n    document.execCommand("copy");\n    document.getSelection().removeAllRanges();\n}\nasync function hash(text) {\n    const msgUint8 = new TextEncoder().encode(text);\n    const buffer = await crypto.subtle.digest(\'SHA-256\', msgUint8);\n    const hashArray = Array.from(new Uint8Array(buffer));\n    const hex = hashArray.map(b => b.toString(16).padStart(2, \'0\')).join(\'\');\n    return hex;\n}\n\n\n\n\n//# sourceURL=webpack:///./src/trh.js?')}});</script></body>


</html>
